---
title: "Лабораторная работа №6"
output: html_notebook
---
Кузнецов Григорий ИУ5-83Б

# Задание

$K$ программистов могут писать программы для выполнения на одном из $M$ серверов, при этом программа не попадает сразу на сервер, а обрабатывается на одном из $N$ специальных компьютеров, которые проверяют отсутствие вирусов. Интенсивность работы программистов $\lambda$, интенсивность работы компьютеров-антивирусов $\nu$, интенсивность работы основных серверов $\mu$, программа оказывается с вирусом с вероятностью $p$. Если программа с вирусом, она получает отказ обслуживания на основных серверах. Для компьютеров по проверке вирусов имеется ограничение по длине очереди $m_1$, для основных серверов ограничение по длине очереди $m_2$.

- Нарисовать граф состояний системы, учитывая количество программистов, которые пишут программу, количество программ на компьютерах-антивирусах, количество программ на серверах;
- Написать уравнения Колмогорова для вероятностей состояний, финальных вероятностей;
- Тремя способами (экспериментально, методом укрупнения состояний, по уравнениям Колмогорова) найти основные характеристики эффективности СМО: среднее время пребывания заявки в системе, абсолютную пропускную способность, среднее число заявок в системе.

# Теоритическое решение

```{r}
Variant<-12
set.seed(Variant) 
K<-sample(c(3:6),1)
M<-sample(c(1:3),1)
N<-sample(c(1:3),1)
lambda<-runif(1)
mu<-runif(1)
nu<-runif(1)
p<-runif(1)
m1<-sample(c(1:2),1)
m2<-sample(c(1:2),1)
View(data.frame(K,M,N,lambda,mu,nu,p,m1,m2))
```


Обозначим $q=1-p$:
Система описывается следующим состоянием: $S_{ijknm}, i = 0..K, j = 0..N, k = 0..M, n = 0..m_1, m = 0..m_2, i+j+k+n+m = K$, где 

- i - количество программистов, подготавливающих программу;
- j - количество работающих компьютеров-антивирусов;
- k - количество серверов, обрабатывающих программу;
- n - количество программ в очереди на проверку на вирусы;
- m - количество программ в очереди на обработку.

![](graf.png)

Составим уравнения Калмогорова:
$$
\frac{dP_{40000}(t)}{dt} = -4\lambda P_{40000}(t) + p\nu P_{31000}(t) + \mu P_{30100}(t)\\
\frac{dP_{31000}(t)}{dt} = -(3\lambda+\nu) P_{31000}(t) + 4\lambda P_{40000}(t) + 2p\nu P_{22000}(t) + \mu P_{21100}(t)\\
\frac{dP_{22000}(t)}{dt} = -(2\lambda + 2\nu) P_{22000}(t) + 3\lambda P_{31000}(t) + 3p\nu P_{13000}(t) + \mu P_{12100}(t)\\
\frac{dP_{13000}(t)}{dt} = -(\lambda + 3\nu) P_{13000}(t) + 2\lambda P_{22000}(t) + 3p\nu P_{03010}(t) + \mu P_{03100}(t)\\
\frac{dP_{03010}}{dt} = -3\nu P_{03010}(t) + \lambda P_{13000}(t)\\
\frac{dP_{30100}(t)}{dt} = -(3\lambda +\mu) P_{30100}(t) + 2p\nu P_{21100}(t) + 2\mu P_{20200}(t) + q\nu P_{31000}(t)\\
\frac{dP_{21100}(t)}{dt} = -(2\lambda +\mu+\nu) P_{30100}(t) + 2p\nu P_{12100}(t) + 2\mu P_{11200}(t) + 2q\nu P_{22000}(t) + 3\lambda P_{30100}(t)\\
\frac{dP_{12100}(t)}{dt} = -(\lambda +\mu+2\nu) P_{12100}(t) + 3p\nu P_{03100}(t) + 2\mu P_{02200}(t) + 3q\nu P_{13000}(t) + 2\lambda P_{21100}(t)\\
\frac{dP_{03100}(t)}{dt} = -(\mu + 3\nu) P_{03100}(t) +\lambda P_{12100}(t)+3q\nu P_{03010}(t)\\
\frac{dP_{20200}}{dt} = -(2\mu+2\lambda)P_{20200}(t) + q\nu P_{21100}(t) + p\nu P_{11200}(t) + 2\mu P_{10201}(t)\\
\frac{P_{11200}}{dt} = -(2\mu+\lambda+\nu)P_{11200}(t) + 2\lambda P_{20200}(t) + 2p\nu P_{02200}(t) + 2q\nu P_{12100}(t)\\
\frac{P_{02200}}{dt} = -(2\mu+2\nu)P_{02200}(t) + \lambda P_{11200}(t) + 3q\nu P_{02200}(t)\\
\frac{P_{10201}}{dt} = -(2\mu+\lambda)P_{10201}(t) + q\nu P_{11200}(t) + p\nu P_{01201}(t)\\
\frac{P_{01201}}{dt} = -(2\mu+\nu)P_{10201}(t) + 2q\nu P_{02200}(t) + \lambda P_{10201}(t)\\
\frac{P_{00202}}{dt} = -2\mu P_{10201}(t) + q\nu P_{01201}(t)\\
$$